var editando=!1,posicaoEditar=0,listaVazia=!0,listaTamanho=0;function validaEnviarFormulario(){var o=!1;return""==$("#nome").val()?(o=!0,notificacao_alerta("Digite um <b>Nome</b>.")):o=!1,o}function validaListaVazia(){var o=!1;return 0==listaTamanho&&(notificacao_alerta("A lista de Modalidades está <b>Vazia</b>."),o=!0),o}function criaOpcaoReferencia(){var o=$("#categoria_ensino option:selected"),e=$("#idade_alunos option:selected"),a=$("#periodo option:selected"),t=$("#num_refeicoes option:selected"),n=$("#id_referencia"),l='<option value="0">Selecione uma opção</option>';for(i in referencias)referencias[i].categoria_ensino==o.val()&&referencias[i].idade_alunos==e.val()&&referencias[i].periodo==a.val()&&referencias[i].num_refeicoes<=t.val()&&(l+='<option value="'+referencias[i].id+'">'+referencias[i].nome+"</option>");n.empty(),n.html(l)}function criaOpcaoReferenciaEdit(){var o=$("#categoria_ensino_edit option:selected"),e=$("#idade_alunos_edit option:selected"),a=$("#periodo_edit option:selected"),t=$("#num_refeicoes_edit option:selected"),n=$("#id_referencia_edit"),l='<option value="0">Selecione uma opção</option>';for(i in referencias)referencias[i].categoria_ensino==o.val()&&referencias[i].idade_alunos==e.val()&&referencias[i].periodo==a.val()&&referencias[i].num_refeicoes<=t.val()&&(l+='<option value="'+referencias[i].id+'">'+referencias[i].nome+"</option>");n.empty(),n.html(l)}function criaOpcaoIdade(o){var e=$("#idade_alunos"),i='<option value="0">Selecione uma opção</option>';1==o?i+='<option value="1">7 - 11 meses</option><option value="2">1 - 3 anos</option>':2==o?i+='<option value="3">4 - 5 anos</option>':3==o?i+='<option value="4">6 - 10 anos</option><option value="5">11 - 15 anos</option>':4==o?i+='<option value="6">16 - 18 anos</option>':5==o?i+='<option value="7">19 - 30 anos</option><option value="8">31 - 60 anos</option>':i='<option value="0">Selecione uma opção</option>',e.empty(),e.html(i)}function criaOpcaoIdadeEdit(o){var e=$("#idade_alunos_edit"),i='<option value="0">Selecione uma opção</option>';1==o?i+='<option value="1">7 - 11 meses</option><option value="2">1 - 3 anos</option>':2==o?i+='<option value="3">4 - 5 anos</option>':3==o?i+='<option value="4">6 - 10 anos</option><option value="5">11 - 15 anos</option>':4==o?i+='<option value="6">16 - 18 anos</option>':5==o?i+='<option value="7">19 - 30 anos</option><option value="8">31 - 60 anos</option>':i='<option value="0">Selecione uma opção</option>',e.empty(),e.html(i)}function criaOpcaoNumRefeicoes(o,e,i){var a=$("#num_refeicoes"),t='<option value="0">Selecione uma opção</option>';1==o&&1==i?t+='<option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option>':1==o&&2==i?t+='<option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option>':2==o&&1==i?t+='<option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option>':2==o&&2==i?t+='<option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option>':3==o&&1==i?t+='<option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option>':3==o&&2==i?t+='<option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option>':4==o&&1==i?t+='<option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option>':4==o&&2==i?t+='<option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option>':5==o&&1==i?t+='<option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option>':5==o&&2==i?t+='<option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option>':t='<option value="0">Selecione uma opção</option>',a.empty(),a.html(t)}function criaOpcaoNumRefeicoesEdit(o,e,i){var a=$("#num_refeicoes_edit"),t='<option value="0">Selecione uma opção</option>';1==o&&1==i?t+='<option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option>':1==o&&2==i?t+='<option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option>':2==o&&1==i?t+='<option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option>':2==o&&2==i?t+='<option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option>':3==o&&1==i?t+='<option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option>':3==o&&2==i?t+='<option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option>':4==o&&1==i?t+='<option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option>':4==o&&2==i?t+='<option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option>':5==o&&1==i?t+='<option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option>':5==o&&2==i?t+='<option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option>':t='<option value="0">Selecione uma opção</option>',a.empty(),a.html(t)}$(document).ready(function(o){function e(){o("#categoria_ensino").val(0),o("#idade_alunos").empty(),o("#idade_alunos").html("<option>Escolha uma opção</option>"),o("#periodo").val(0),o("#num_alunos").val(0),o("#num_refeicoes").empty(),o("#num_refeicoes").html("<option>Escolha uma opção</option>"),o("#id_referencia").empty(),o("#id_referencia").html("<option>Escolha uma opção</option>")}function i(){var e,a;(e=o(".botaoEditar")).off(),e.each(function(e,i){o(i).click(function(){var i=o(o(".idCategoria")[e]),a=o(o(".idIdade")[e]),t=o(o(".idPeriodo")[e]),n=o(o(".idRefeicao")[e]),l=o(o(".numAlunos")[e]),p=o(o(".idReferencia")[e]);posicaoEditar=e,editando=!0,o("#categoria_ensino_edit").val(i.html()),criaOpcaoIdadeEdit(i.html()),o("#idade_alunos_edit").val(a.html()),o("#periodo_edit").val(t.html()),criaOpcaoNumRefeicoesEdit(i.html(),a.html(),t.html()),o("#num_alunos_edit").val(l.html()),o("#num_refeicoes_edit").val(n.html()),criaOpcaoReferenciaEdit(),o("#id_referencia_edit").val(p.html())})}),(a=o(".botaoRemover")).off(),a.each(function(e,a){o(a).click(function(){o(o(".idCategoria")[e]),o(o(".idIdade")[e]),o(o(".idPeriodo")[e]),o(o(".idRefeicao")[e]),o(o(".numAlunos")[e]),o(o(".idReferencia")[e]),o(o(".listaItem")[e]).remove(),listaTamanho--,i(),0==listaTamanho&&(o("#listaVazia").show(),listaVazia=!0),notificacao_sucesso("Item <b>removido</b> com sucesso."),o("#nicescroll").getNiceScroll().resize()})})}o(function(){var e=o("#id_form").serialize();o("#confBotaoEnviar").click(function(){window.onbeforeunload=null}),o("#confBotaoEnviarUpdate").click(function(){window.onbeforeunload=null}),o("#btn_cancelar").click(function(){window.onbeforeunload=null}),window.onbeforeunload=function(){return o("#id_form").serialize()===e?null:"Os dados do formulário não foram salvos, deseja permanecer nesta página?"}}),o("#nicescroll").niceScroll(),o("#categoria_ensino").change(function(){o("#idade_alunos").empty(),o("#idade_alunos").html(criaOpcaoIdade(o("#categoria_ensino option:selected").val())),o("#periodo").val(0),o("#num_refeicoes").empty(),o("#num_refeicoes").html("<option>Selecione uma opção</option>"),o("#id_referencia").empty(),o("#id_referencia").html("<option>Selecione uma opção</option>"),o("#num_alunos").val(0)}),o("#categoria_ensino_edit").change(function(){o("#idade_alunos_edit").empty(),o("#idade_alunos_edit").html(criaOpcaoIdadeEdit(o("#categoria_ensino_edit option:selected").val())),o("#periodo_edit").val(0),o("#num_refeicoes_edit").empty(),o("#num_refeicoes_edit").html("<option>Selecione uma opção</option>"),o("#id_referencia_edit").empty(),o("#id_referencia_edit").html("<option>Selecione uma opção</option>"),o("#num_alunos_edit").val(0)}),o("#idade_alunos").change(function(){o("#periodo").val(0),o("#num_refeicoes").empty(),o("#num_refeicoes").html("<option>Selecione uma opção</option>"),o("#id_referencia").empty(),o("#id_referencia").html("<option>Selecione uma opção</option>"),o("#num_alunos").val(0)}),o("#idade_alunos_edit").change(function(){o("#periodo_edit").val(0),o("#num_refeicoes_edit").empty(),o("#num_refeicoes_edit").html("<option>Selecione uma opção</option>"),o("#id_referencia_edit").empty(),o("#id_referencia_edit").html("<option>Selecione uma opção</option>"),o("#num_alunos_edit").val(0)}),o("#periodo").change(function(){o("#num_refeicoes").empty(),o("#num_refeicoes").html(criaOpcaoNumRefeicoes(o("#categoria_ensino option:selected").val(),o("#idade_alunos option:selected").val(),o("#periodo option:selected").val())),o("#id_referencia").empty(),o("#id_referencia").html("<option>Selecione uma opção</option>")}),o("#periodo_edit").change(function(){o("#num_refeicoes_edit").empty(),o("#num_refeicoes_edit").html(criaOpcaoNumRefeicoesEdit(o("#categoria_ensino_edit option:selected").val(),o("#idade_alunos_edit option:selected").val(),o("#periodo_edit option:selected").val())),o("#id_referencia_edit").empty(),o("#id_referencia_edit").html("<option>Selecione uma opção</option>")}),o("#num_refeicoes").change(function(){criaOpcaoReferencia()}),o("#num_refeicoes_edit").change(function(){criaOpcaoReferenciaEdit()}),i(),o("#botaoAdicionar").click(function(){var a,t,n,l,p,c,d;(function(){var e=!1,i=o("#categoria_ensino option:selected"),a=o("#idade_alunos option:selected"),t=o("#periodo option:selected"),n=o("#num_alunos"),l=o("#num_refeicoes option:selected"),p=o("#id_referencia option:selected");if(i.val()<=0)e=!0,notificacao_alerta("Selecine uma <b>Categoria de Ensino</b>.");else if(a.val()<=0)e=!0,notificacao_alerta("Selecine um <b>Faixa de Idade</b>.");else if(t.val()<=0)e=!0,notificacao_alerta("Selecine um <b>Período</b>.");else if(n.val()<=0||""==n.val())e=!0,notificacao_alerta("Digite o <b>Número de Alunos</b>.");else if(l.val()<=0)e=!0,notificacao_alerta("Selecione um <b>Número de Refeições</b>.");else if(p.val()<=0)e=!0,notificacao_alerta("Selecione uma <b>Referência Nutricional</b>.");else for(var c=o('var[class="idCategoria"]'),d=o('var[class="idIdade"]'),s=o('var[class="idPeriodo"]'),r=0;r<c.length;r++)if(o(c[r]).html()==i.val()&&o(d[r]).html()==a.val()&&o(s[r]).html()==t.val())return e=!0,notificacao_alerta("<b>Modalidade</b> já incluída."),e;return e})()||(1==listaVazia&&o("#listaVazia").hide(),a=o("#categoria_ensino option:selected"),t=o("#idade_alunos option:selected"),n=o("#periodo option:selected"),l=o("#num_alunos"),p=o("#num_refeicoes option:selected"),c=o("#id_referencia option:selected"),d='<div class="listaItem"><li class="panel label-azul"><div class="row"><var class="idModalidade" style="display: none">99999999</var><var class="idCategoria" style="display: none">'+a.val()+'</var><var class="idIdade" style="display: none">'+t.val()+'</var><var class="idPeriodo" style="display: none">'+n.val()+'</var><var class="numAlunos" style="display: none">'+l.val()+'</var><var class="idRefeicao" style="display: none">'+p.val()+'</var><var class="idReferencia" style="display: none">'+c.val()+'</var><div class="col-md-3 wrapper categoria" style="margin-top: 5px">'+a.text()+'</div><div class="col-md-3 wrapper idade" style="margin-top: 5px">'+t.text()+'</div><div class="col-md-2 wrapper periodo" style="margin-top: 5px">'+n.text()+'</div><div class="col-md-2 wrapper alunos" style="margin-top: 5px">'+l.val()+'</div><div class="col-md-1 text-center"><a class="btn btn-default botaoEditar" data-toggle="modal" data-target="#editar_modalidade"><i class="fa fa-edit"></i></a></div><div class="col-md-1 text-center"><button class="btn btn-danger botaoRemover data-toggle="tooltip" data-placement="top" title="Excluir"><i class="fa fa-trash"></i></button></div></div></li></div>',o("#listaItens").append(d),o("#nicescroll").getNiceScroll().resize(),listaTamanho++,notificacao_sucesso("Item <b>adicionado</b> com sucesso."),e(),i())}),o("#concluir_edicao").click(function(){var e,a,t,n,l,p;(function(){var e=!1,i=o("#categoria_ensino_edit option:selected"),a=o("#idade_alunos_edit option:selected"),t=o("#periodo_edit option:selected"),n=o("#num_alunos_edit"),l=o("#num_refeicoes_edit option:selected"),p=o("#id_referencia_edit option:selected");if(i.val()<=0)e=!0,notificacao_alerta("Selecine uma <b>Categoria de Ensino</b>.");else if(a.val()<=0)e=!0,notificacao_alerta("Selecine um <b>Faixa de Idade</b>.");else if(t.val()<=0)e=!0,notificacao_alerta("Selecine um <b>Período</b>.");else if(n.val()<=0||""==n.val())e=!0,notificacao_alerta("Digite o <b>Número de Alunos</b>.");else if(l.val()<=0)e=!0,notificacao_alerta("Selecione um <b>Número de Refeições</b>.");else if(p.val()<=0)e=!0,notificacao_alerta("Selecione uma <b>Referência Nutricional</b>.");else for(var c=o('var[class="idCategoria"]'),d=o('var[class="idIdade"]'),s=o('var[class="idPeriodo"]'),r=0;r<c.length;r++)if(o(c[r]).html()==i.val()&&o(d[r]).html()==a.val()&&o(s[r]).html()==t.val()&&r!=posicaoEditar)return e=!0,notificacao_alerta("<b>Modalidade</b> já incluída."),e;return e})()||(e=o("#categoria_ensino_edit option:selected"),a=o("#idade_alunos_edit option:selected"),t=o("#periodo_edit option:selected"),n=o("#num_alunos_edit"),l=o("#num_refeicoes_edit option:selected"),p=o("#id_referencia_edit option:selected"),o(o(".idCategoria")[posicaoEditar]).html(e.val()),o(o(".idIdade")[posicaoEditar]).html(a.val()),o(o(".idPeriodo")[posicaoEditar]).html(t.val()),o(o(".idRefeicao")[posicaoEditar]).html(l.val()),o(o(".numAlunos")[posicaoEditar]).html(n.val()),o(o(".idReferencia")[posicaoEditar]).html(p.val()),o(o(".categoria")[posicaoEditar]).html(e.text()),o(o(".idade")[posicaoEditar]).html(a.text()),o(o(".periodo")[posicaoEditar]).html(t.text()),o(o(".alunos")[posicaoEditar]).html(n.val()),editando=!1,notificacao_sucesso("Item <b>editado</b> com sucesso."),o("#editar_modalidade").modal("hide"),i())}),o("#confBotaoEnviar").click(function(){var e,i,a;validaEnviarFormulario()||validaListaVazia()||(o(this).addClass("disabled"),o(this).text("Enviando..."),e=o("#nome").val(),i=o("#descricao").val(),a=[],o('var[class="idCategoria"]').each(function(t,n){a.hasOwnProperty(t)||(a[t]={nome:e,descricao:i}),a[t][o(this).attr("class")]=o(this).html()}),o('var[class="idIdade"]').each(function(t,n){a.hasOwnProperty(t)||(a[t]={nome:e,descricao:i}),a[t][o(this).attr("class")]=o(this).html()}),o('var[class="idPeriodo"]').each(function(t,n){a.hasOwnProperty(t)||(a[t]={nome:e,descricao:i}),a[t][o(this).attr("class")]=o(this).html()}),o('var[class="idRefeicao"]').each(function(t,n){a.hasOwnProperty(t)||(a[t]={nome:e,descricao:i}),a[t][o(this).attr("class")]=o(this).html()}),o('var[class="numAlunos"]').each(function(t,n){a.hasOwnProperty(t)||(a[t]={nome:e,descricao:i}),a[t][o(this).attr("class")]=o(this).html()}),o('var[class="idReferencia"]').each(function(t,n){a.hasOwnProperty(t)||(a[t]={nome:e,descricao:i}),a[t][o(this).attr("class")]=o(this).html()}),o.ajaxSetup({headers:{"X-CSRF-TOKEN":o('meta[name="csrf-token"]').attr("content")}}),o.ajax({url:"/school/save",type:"post",dataType:"text",data:{testdata:JSON.stringify(a)},success:function(o,e){location.reload()},error:function(o,e,i){console.log(i)}}))})});
